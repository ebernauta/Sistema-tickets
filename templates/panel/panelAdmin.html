<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css"
        href="https://cdn.datatables.net/v/dt/jszip-2.5.0/dt-1.10.23/b-1.6.5/b-html5-1.6.5/fc-3.3.2/fh-3.1.8/datatables.min.css" />
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script type="text/javascript"
        src="https://cdn.datatables.net/v/dt/jszip-2.5.0/dt-1.10.23/b-1.6.5/b-html5-1.6.5/fc-3.3.2/fh-3.1.8/datatables.min.js"></script>
    <title>Panel de administración</title>
</head>

<body>
    <div class="text-center bg-dark-subtle">
        <h1>Panel de administración</h1>
    </div>
    <div class="container">
        <header class="d-flex flex-wrap justify-content-center py-3 mb-4 border-bottom ">
            <a class="d-flex align-items-center mb-3 mb-md-0 me-md-auto text-dark text-decoration-none">
                <img src="\static\img\logo.png" alt="logo" class="img-thumbnail" width="65" height="70">
                <span class="fs-3">&nbsp;&nbsp;Bienvenido, {{current_user.fullname}}</span>
            </a>
            <ul class="nav">
                <li class="nav-item m-1"><a href="{{url_for ('usuariosPanel') }}" class="btn btn-secondary">Usuarios</a>
                </li>
                <li class="nav-item m-1"><a href="{{ url_for ('departamentosPanel') }}"
                        class="btn btn-secondary">Departamentos</a></li>
                <li class="nav-item m-1"><a href="{{ url_for ('logout') }}" class="btn btn-danger">Cerrar Sesión</a>
                </li>
            </ul>
        </header>
    </div>
    <div class="container">
        <table id="miTabla">
            <thead>
                <tr>
                    <th>#ID ticket</th>
                    <th>ID usuario</th>
                    <th>Funcionario</th>
                    <th>Departamento</th>
                    <th>Tipo de problema</th>
                    <th>Descripcion</th>
                    <th>Estado</th>
                    <th>Generado</th>
                </tr>
            </thead>
        </table>
    </div>
    <script type="text/javascript">
        $(document).ready(function () {
            $('#miTabla').DataTable({
                "ajax": "/dataTickets",
                "columns": [
                    { "data": "id_ticket" },
                    { "data": "user_id" },
                    { "data": "user_fullname" },
                    { "data": "departamento" },
                    { "data": "tipo_problema" },
                    { "data": "descripcion",
                    "render": function(data, type, row){
                        if(type === 'display'){
                            return data.length > 100 ?
                                data.substr(0, 100) + '...' :
                                data;
                        } else {
                            return data;
                        }
                    }
                },
                    { "data": "estado" },
                    { "data": "created_at" }
                ],
                "language": {
                    "sProcessing": "Procesando...",
                    "sLengthMenu": "Mostrar _MENU_ registros por pagina",
                    "sZeroRecords": "No se encontraron resultados",
                    "sEmptyTable": "No hay registros de tickets en la tabla",
                    "sInfo": "Mostrando registros de _START_ al _END_ de un total de _TOTAL_ registros",
                    "sInfoEmpty": "Mostrando registros del 0 al 0 de un total de 0 registros",
                    "sInfoFiltered": "(filtrado de un total de _MAX_ registros)",
                    "sSearch": "Buscar:",
                    "oPaginate": {
                        "sFirst": "Primero",
                        "sLast": "Ultimo",
                        "sNext": "Siguiente",
                        "sPrevious": "Anterior"
                    },
                    "oAria": {
                        "sSortAscending": ": Activar para ordenar la columna de manera ascendente",
                        "sSortDescending": ": Activar para ordenar la columna de manera descendente"
                    }
                }
            });
        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>